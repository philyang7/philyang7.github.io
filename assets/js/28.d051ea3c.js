(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{534:function(a,s,t){"use strict";t.r(s);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},r=t(2),e=Object(r.a)(n,function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.slotKey}},[t("h1",{attrs:{id:"jenkins持续集成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jenkins持续集成","aria-hidden":"true"}},[a._v("#")]),a._v(" jenkins持续集成")]),a._v(" "),t("hr"),a._v(" "),t("h3",{attrs:{id:"部署java项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#部署java项目","aria-hidden":"true"}},[a._v("#")]),a._v(" 部署java项目")]),a._v(" "),t("ol",[t("li",[a._v("shell1")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mvn clean package -DskipTests -U\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("shell2")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token string"}},[a._v("'stop app...'")]),a._v("\n"),t("span",{attrs:{class:"token function"}},[a._v("ssh")]),a._v(" root@192.168.0.204 "),t("span",{attrs:{class:"token string"}},[a._v("'/app/zx-open-platform/script/stop-app.sh'")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[a._v("#! /usr/bin/bash")]),a._v("\n\napp_name"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("zx-open-platform\napp_version"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("1.0.0\n\nstr"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[t("span",{attrs:{class:"token variable"}},[a._v("$(")]),t("span",{attrs:{class:"token function"}},[a._v("ps")]),a._v(" -ef"),t("span",{attrs:{class:"token operator"}},[a._v("|")]),t("span",{attrs:{class:"token function"}},[a._v("grep")]),a._v(" $app_name-$app_version.jar"),t("span",{attrs:{class:"token operator"}},[a._v("|")]),t("span",{attrs:{class:"token function"}},[a._v("grep")]),a._v(" -v "),t("span",{attrs:{class:"token string"}},[a._v("'grep'")]),t("span",{attrs:{class:"token operator"}},[a._v("|")]),t("span",{attrs:{class:"token function"}},[a._v("awk")]),a._v(" "),t("span",{attrs:{class:"token string"}},[a._v("'{print "),t("span",{attrs:{class:"token variable"}},[a._v("$2")]),a._v("}'")]),t("span",{attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n\n"),t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token function"}},[a._v("kill")]),a._v(" -9 "),t("span",{attrs:{class:"token variable"}},[a._v("$str")]),a._v("\n"),t("span",{attrs:{class:"token function"}},[a._v("kill")]),a._v(" -9 "),t("span",{attrs:{class:"token variable"}},[a._v("$str")]),a._v("\n\n"),t("span",{attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),t("span",{attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),t("span",{attrs:{class:"token string"}},[a._v("'"),t("span",{attrs:{class:"token variable"}},[a._v("$?")]),a._v("'")]),a._v(" -eq 0 "),t("span",{attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{attrs:{class:"token punctuation"}},[a._v(";")]),t("span",{attrs:{class:"token keyword"}},[a._v("then")]),a._v("\n  "),t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token function"}},[a._v("kill")]),a._v(" "),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v(" Success,pid"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$str")]),a._v("\n"),t("span",{attrs:{class:"token keyword"}},[a._v("else")]),a._v("\n  "),t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token function"}},[a._v("kill")]),a._v(" "),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v(" Failed,pid"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$str")]),a._v("\n"),t("span",{attrs:{class:"token keyword"}},[a._v("fi")]),a._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("shell3")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token string"}},[a._v("'copy jar...'")]),a._v("\n"),t("span",{attrs:{class:"token function"}},[a._v("scp")]),a._v(" ./target/zx-open-platform-1.0.0.jar root@192.168.0.204:/app/zx-open-platform\n")])])]),t("p",[a._v("4.shell4")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),t("span",{attrs:{class:"token string"}},[a._v("'start app...'")]),a._v("\n"),t("span",{attrs:{class:"token function"}},[a._v("ssh")]),a._v(" root@192.168.0.204 "),t("span",{attrs:{class:"token string"}},[a._v("'/app/zx-open-platform/script/start-app.sh'")]),a._v("\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[a._v("#! /usr/bin/bash ")]),a._v("\n\n"),t("span",{attrs:{class:"token function"}},[a._v("export")]),a._v(" JAVA_HOME"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/java/jdk-11.0.2\n"),t("span",{attrs:{class:"token function"}},[a._v("export")]),a._v(" PATH"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/bin:"),t("span",{attrs:{class:"token variable"}},[a._v("$PATH")]),a._v("\n\napp_name"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("zx-open-platform\napp_version"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("1.0.0\n\nJMX_PORT"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("9081\nJMX_OPS"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("-javaagent:/app/jmx-reporter/jmx_prometheus_javaagent-0.16.1.jar"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$JMX_PORT")]),a._v(":/app/jmx-reporter/jmx_exporter_config.yml\n\nSW_OPS"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("-javaagent:/app/skywalking/agent/skywalking-agent.jar"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("agent.service_name"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v(",collector.backend_service"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("192.168.0.203:11800\n\n"),t("span",{attrs:{class:"token function"}},[a._v("cd")]),a._v(" /app/"),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v("\n"),t("span",{attrs:{class:"token function"}},[a._v("nohup")]),a._v(" java "),t("span",{attrs:{class:"token variable"}},[a._v("$JMX_OPS")]),a._v(" "),t("span",{attrs:{class:"token variable"}},[a._v("$SW_OPS")]),a._v(" -jar /app/"),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v("/"),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v("-"),t("span",{attrs:{class:"token variable"}},[a._v("$app_version")]),a._v(".jar --spring.profiles.active"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("sit -Djava.awt.headless"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("true "),t("span",{attrs:{class:"token operator"}},[a._v(">")]),a._v(" /app/"),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v("/run."),t("span",{attrs:{class:"token variable"}},[a._v("$app_name")]),a._v(".log 2"),t("span",{attrs:{class:"token operator"}},[a._v(">")]),t("span",{attrs:{class:"token operator"}},[a._v("&")]),a._v("1 "),t("span",{attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])])]),t("hr"),a._v(" "),t("h3",{attrs:{id:"生成jar包到maven私服"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成jar包到maven私服","aria-hidden":"true"}},[a._v("#")]),a._v(" 生成jar包到maven私服")]),a._v(" "),t("ol",[t("li",[a._v("shell1")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mvn clean package -DskipTests -U\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("shell3")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("jar_version"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("1.0.3\nmvn deploy:deploy-file -Dfile"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("./target/zx-bank-front-api-"),t("span",{attrs:{class:"token variable"}},[a._v("$jar_version")]),a._v(".jar -DgroupId"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("com.zxjztech.bank -DartifactId"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("zx-bank-front-api -Dversion"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),t("span",{attrs:{class:"token variable"}},[a._v("$jar_version")]),a._v(" -Dpackaging"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("jar  -Durl"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("http://192.168.0.12:8081/repository/maven-zxtech/ -DrepositoryId"),t("span",{attrs:{class:"token operator"}},[a._v("=")]),a._v("maven-zxtech\n\n")])])]),t("hr"),a._v(" "),t("h3",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#","aria-hidden":"true"}},[a._v("#")])])])},[],!1,null,null,null);e.options.__file="jenkins.md";s.default=e.exports}}]);