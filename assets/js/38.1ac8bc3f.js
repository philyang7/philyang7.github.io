(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{545:function(e,t,a){"use strict";a.r(t);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},s=a(2),r=Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.slotKey}},[a("h1",{attrs:{id:"java代码块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java代码块","aria-hidden":"true"}},[e._v("#")]),e._v(" Java代码块")]),e._v(" "),a("p",[e._v("这里记录一些简便有趣的Java代码段。")]),e._v(" "),a("hr"),e._v(" "),a("h3",{attrs:{id:"产生两个数之间的随机数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#产生两个数之间的随机数","aria-hidden":"true"}},[e._v("#")]),e._v(" 产生两个数之间的随机数")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("int pow = (int) Math.pow(10, 3); // 用于提取指定小数位\ndateTrue = Math.floor((Math.random() * (max - min) + min) * pow) / pow;\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"数字格式化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数字格式化","aria-hidden":"true"}},[e._v("#")]),e._v(" 数字格式化")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("NumberFormat nf = NumberFormat.getPercentInstance();//百分比格式\nnf.setMinimumFractionDigits(0);//保留n位小数\nnf.format(2.22);\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"删除重复数据且只留一条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除重复数据且只留一条","aria-hidden":"true"}},[e._v("#")]),e._v(" 删除重复数据且只留一条")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("delete from t_reception_visit_a16_copy1 \nwhere  (visit_time,resident_id) in (select visit_time,resident_id  from t_reception_visit_a16_copy1 group by visit_time,resident_id  having count(1) > 1) \nand  id not in (select min(id) from t_reception_visit_a16_copy1 group by visit_time,resident_id having count(1)>1)\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"查询锁表进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询锁表进程","aria-hidden":"true"}},[e._v("#")]),e._v(" 查询锁表进程")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("select concat('KILL ',id,';') from information_schema.processlist p inner\njoin information_schema.INNODB_TRX x on p.id=x.trx_mysql_thread_id where db='shequyun-sharding';\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"esdump备份和恢复到文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#esdump备份和恢复到文件","aria-hidden":"true"}},[e._v("#")]),e._v(" esdump备份和恢复到文件")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('#备份\nelasticdump  --input http://localhost:9200/syslog --output /home/syslog.json --type=data\n#恢复\nelasticdump --input /opt/shihuc/robotkdb.json --output "http://10.90.7.10:9200/robotkdb”\n')])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"es-index相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es-index相关","aria-hidden":"true"}},[e._v("#")]),e._v(" es index相关")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#创建一个index\ncurl -H “Content-Type:application/json” -XPUT http://localhost:9200/syslog\n#查询所有index\nGET：http://172.31.27.170:9200/_cat/indices?v\n#删除指定index中所有数据\ncurl --location --request POST 'http://172.31.27.170:9200/t_person_wide_wgs/_delete_by_query' --header 'Content-Type: application/json' --data-raw '{\n  \"query\": {\n    \"match_all\": {}\n  }\n}'\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"批量执行sh命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量执行sh命令","aria-hidden":"true"}},[e._v("#")]),e._v(" 批量执行sh命令")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("for file in ls /data/misc/scripttest/*.sh\ndo\nnohup sh $file > $file.log &\ndone\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"mat分析headdump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mat分析headdump","aria-hidden":"true"}},[e._v("#")]),e._v(" mat分析headdump")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#m.hprof就是jvm的dump文件，在mat目录下会生成3份.zip结尾的报告和一些m.相关的文件，将生成的m.hprof相关的文件都下载到windows本地磁盘\n./ParseHeapDump.sh m.hprof  org.eclipse.mat.api:suspects org.eclipse.mat.api:overview org.eclipse.mat.api:top_components\n")])])]),a("hr"),e._v(" "),a("h3",{attrs:{id:"logstash配置文件示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logstash配置文件示例","aria-hidden":"true"}},[e._v("#")]),e._v(" logstash配置文件示例")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('input {\n        stdin {}\n\n\n        jdbc {\n                type => "shequyun-sharding_t_community_org_a03"\n                jdbc_connection_string => "jdbc:mysql://172.31.27.178:3306/shequyun-sharding?characterEncoding=UTF-8&autoReconnect=true&serverTimezone=GMT%2B8"\n                jdbc_user => "root"\n                jdbc_password => "communitycloud"\n                jdbc_driver_library => "/home/logstash-7.10.0/mysql/mysql-connector-java-8.0.22.jar"\n                jdbc_driver_class => "com.mysql.jdbc.Driver"\n                connection_retry_attempts => "3"\n                jdbc_validate_connection => "true"\n                jdbc_validation_timeout => "3600"\n                jdbc_paging_enabled => "true"\n                jdbc_page_size => "500"\n                statement => "SELECT id,cid,corg_name,pid,level,create_user,create_time,update_user,update_time,sys_org_code,del_flag,corg_order,icon,is_doorplate_node,node_typename,house_address,landlord_name,landlord_tel,remark,is_rent_out,org_code,is_keep_a_dog,dog_count,is_empty_close,person_count,house_count,zone_code,upper_cloud,tag_infos,car_info FROM `t_community_org_a03` WHERE update_time > :sql_last_value order by update_time asc"\n                lowercase_column_names => false\n                sql_log_level => warn\n                record_last_run => true\n                use_column_value => true\n                tracking_column => "update_time"\n                tracking_column_type => timestamp\n                last_run_metadata_path => "mysql/last_id_community_org_a03.txt"\n                clean_run => false\n                schedule => "*/10 * * * * *"\n                #设置默认时区，:sql_last_value的值就会从UTC转为设置的时区时间\n                jdbc_default_timezone => "Asia/Shanghai"\n        }\n\n        jdbc {\n                type => "shequyun-sharding_t_community_org_a16"\n                jdbc_connection_string => "jdbc:mysql://172.31.27.178:3306/shequyun-sharding?characterEncoding=UTF-8&autoReconnect=true&serverTimezone=GMT%2B8"\n                jdbc_user => "root"\n                jdbc_password => "communitycloud"\n                jdbc_driver_library => "/home/logstash-7.10.0/mysql/mysql-connector-java-8.0.22.jar"\n                jdbc_driver_class => "com.mysql.jdbc.Driver"\n                connection_retry_attempts => "3"\n                jdbc_validate_connection => "true"\n                jdbc_validation_timeout => "3600"\n                jdbc_paging_enabled => "true"\n                jdbc_page_size => "500"\n                statement => "SELECT id,cid,corg_name,pid,level,create_user,create_time,update_user,update_time,sys_org_code,del_flag,corg_order,icon,is_doorplate_node,node_typename,house_address,landlord_name,landlord_tel,remark,is_rent_out,org_code,is_keep_a_dog,dog_count,is_empty_close,person_count,house_count,zone_code,upper_cloud,tag_infos,car_info FROM `t_community_org_a16` WHERE update_time > :sql_last_value order by update_time asc"\n                lowercase_column_names => false\n                sql_log_level => warn\n                record_last_run => true\n                use_column_value => true\n                tracking_column => "update_time"\n                tracking_column_type => timestamp\n                last_run_metadata_path => "mysql/last_id_community_org_a16.txt"\n                clean_run => false\n                schedule => "*/10 * * * * *"\n                #设置默认时区，:sql_last_value的值就会从UTC转为设置的时区时间\n                jdbc_default_timezone => "Asia/Shanghai"\n        }\n}\n\n\n\noutput {\n\n        if [type] == "shequyun-sharding_t_community_org_a03" {\n                elasticsearch {\n                        hosts => ["172.31.27.170:9200"]\n                        index => "community_org_a03"\n                        document_id => "%{id}"\n                }\n        }\n\n        if [type] == "shequyun-sharding_t_community_org_a16" {\n                elasticsearch {\n                        hosts => ["172.31.27.170:9200"]\n                        index => "community_org_a16"\n                        document_id => "%{id}"\n                }\n        }\n\n        stdout {\n                codec => json_lines\n        }\n}\n')])])])])},[],!1,null,null,null);r.options.__file="java-code-block.md";t.default=r.exports}}]);